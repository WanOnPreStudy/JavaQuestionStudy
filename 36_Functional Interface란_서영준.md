# 들어가며…

함수형 인터페이스란 자바가 함수형 프로그래밍의 기능을 따라가기 위해 제공하는 인터페이스입니다.

그렇다면, 자바는 왜 굳이 없었던 인터페이스까지 만들어 가며 함수형 프로그래밍의 기능을 제공하려고 하는 것일까요?

함수형 프로그래밍이 뭐길래? 뭐가 좋길래?

이번 글에서는 함수형 프로그래밍이란 무엇인지, 장점은 무엇인지, 자바에서는 어떻게 함수형 프로그래밍 기능을 제공하고 있는지 알아보도록하겠습니다.

# 함수형 프로그래밍이란?

위키 백과의 설명에 따르면 함수형 프로그래밍은 수학적 **함수의 계산을 통해 자료를 처리하고 상태와 가변 데이터를 멀리하는 프로그래밍 패러다임** 중 하나라고 합니다.

기존의 객체 지향 프로그래밍이 책임과 역할을 나누고, 객체 간 메세지와 협력 관계에 의해 기능을 수행한다면, 함수형 프로그래밍은 단순히 기능을 처리하는 함수들의 조합으로 작동하는 것이라고 표현할 수 있겠네요.

예를 들어 주문한 차량을 조립하는 로직이 있다고 가정해 보겠습니다.

객체 지향 프로그래밍을 통해 로직을 구현한다면 각 객체에게 주어진 역할을 부여하고 객체의 상태와 행동에 따라 메세지를 보내 로직을 수행하겠죠?

![객체지향 PNG](https://user-images.githubusercontent.com/90227655/203537711-0b51e6a8-5a45-4af8-a0a1-6914ef227e3a.png)

함수형 프로그래밍이라면 어떨까요?

함수형 프로그래밍은 단순한 함수들의 조합을 통해 로직을 구현하게 됩니다. 들어온 요청은 타이어를 생성하는 함수를 거쳐 타이어를 가지게 되고, 외 골격을 만들어 주는 함수를 거쳐 외골격을 구성하고, 도색하는 함수를 거쳐 도색이 입혀지며 최후에 차량을 완성하게 되죠.

![함수형 PNG](https://user-images.githubusercontent.com/90227655/203537701-81a0e8e2-3218-44e5-8429-b0fdc9d9f2f9.png)

하지만 위와 같은 로직이 잘 작동하려면 이전 함수에서 실행한 값이 잘못되지 않았다는 것을 보장해야 합니다. 또 다음 함수가 항상 잘 작동한다는 것도 보장해주어야 하죠.

함수형 프로그래밍에선 이를 순수 함수라는 개념을 통해 보장해줍니다.

# 순수 함수

**순수 함수란 동일한 매개변수가 주어지면 항상 동일한 결과를 반환하는 함수이며, 부수 효과(Side Effect)가 없는 함수를 뜻합니다.**

```java
// 순수 함수
public int addPure(int a, int b) {
    return a + b;
}

// 순수 함수
public List<Integer> getList(int a, int b, int c) {
    return Arrays.asList(a, b, c);
}
```

### 1. 동일한 매개변수가 주어지면 항상 같은 결과를 반환해야 한다.

말 그대로 같은 값이 매개변수로 주어지면 항상 같은 결과를 반환해야 한다는 것입니다. 항상 같은 값을 반환하기 위해 **외부의 변수에 영향을 받지 않고**, **매개변수와 함수 내부의 상수들로만 계산된 결과를 반환**해야 한다는 것이죠.

```java
List<Integer> arr = Arrays.asList(10, 20, 30);

// 불순 함수
public int addImpure(int a, int b) {
    // 외부의 값에 의해 영향을 받음
    // 같은 입력이라도 결과가 달라짐
    return a + b + arr.get(0);
}
```

### 2. 원래 목적과 다른 효과(부수 효과, Side Effect)를 만들지 말아야한다.

부수 효과란 함수가 만들어진 목적과는 다른 효과 또는 부작용입니다. 쉽게 말해 **함수 외부의 값을 변경하거나, I/O 작업을 하면 안된다는 것**이죠. 코드를 통해 보도록 하겠습니다.

```java
List<Integer> arr = Arrays.asList(10, 20, 30);

// 불순 함수
public List<Integer> addArray(List<Integer> list) {
    // 매개 변수의 값을 직접 변경하는 불순 함수 or
    // 외부의 값에 영향을 주는 함수
    list.add(40);
    return list;
}

// 불순함수
public String input() {
    // Input 혹은 Output 작업을 포함한 함수
    Scanner s = new Scanner(System.in);
    return s.nextLine();
}
```

# 함수형 프로그래밍이 주목 받는 이유?

함수형 프로그래밍은 사실 1950년대부터 고안된 프로그래밍 패러다임입니다. 그런데 왜 이제 와서 주목 받게 된 것일까요?

### 하드웨어 성능의 한계와 빅데이터, 동시성

2000년대 초반까지는 CPU의 클럭 증가, 실행 시간 최적화, Cache의 크기 증가 등의 이유로 특별한 소프트웨어적 처리 없이도 싱글 프로세스, 싱글 스레드 프로그램의 처리량이 향상되었다고 합니다.

이러한 하드웨어적 발전이 극에 달하면서 **단일 코어에서 CPU 클럭 증가가 현실적으로 어려운 상황**이 되었고, 동시에 페타급 이상의 **빅데이터의 시대가 시작되면서** 프로그램의 처리량을 높이기 위해 자연스럽게 **멀티 코어, 멀티 스레드를 활용한** **동시, 병렬 처리가 필요하게 되었습니다.**

### 동시성 프로그램을 작성하기 쉽다

**동시성 프로그램을 작성하기 힘든 이유는 여러 스레드들이 프로그램 상태를 공유하기 때문**입니다. **함수형 프로그래밍 패러다임에서는 변경 가능한 상태를 원칙적으로 배제**하기 때문에 프로그래머는 잠금과 동기화 같은 문제에서 벗어나 핵심 로직 구현에 집중할 수 있습니다.

### 프로그램의 검증이 쉽다.

프로그램을 구성하는 모듈들이 오로지 입력 값의 영향만 받기 때문에 테스트 코드 작성이 쉽고, 프로그래머가 예측하지 못하는 시점에 변경될 수 있는 내부 상태가 없기 때문에 예측이 쉽다는 장점이 있습니다.

### 최적화가 가능하다.

같은 입력이 들어오면 같은 출력을 보낸다는 말은 캐시를 사용할 수 있다는 말과 같습니다. 들어온 입력과 출력을 캐싱해 두었다가 다시 한번 같은 입력이 들어오면 캐싱된 값을 출력할 수 있습니다. 캐싱 뿐 아니라 함수형 프로그래밍이 가지는 순수 함수는 많은 최적화의 근거가 될 수 있습니다.

# 자바에서 구현한 함수형 프로그래밍

# 일등 시민 or 일급 객체

함수형 프로그래밍에서 함수는 일급 객체(First-class Object)입니다. 일급 객체란 다른 객체들에 일반적으로 적용 가능한 연산을 모두 지원하는 객체를 말합니다.

```java

let result = mulNum(mul, 3); // 9

function mul(num) {
  return num*num;
}

// func는 매개변수임, 이름은 아무거나 지정해도 상관없음
function mulNum(func, number) {
  return func(number);
}
```

**1. 변수나 데이터에 할당 할 수 있어야 한다.**

**2. 객체의 인자로 넘길 수 있어야 한다.**

**3. 객체의 리턴값으로 리턴 할 수 있어야 한다.**

즉, 함수나 클래스를 일반적인 데이터(string, number, boolean, array, object) 다루 듯이 다룰 수 있다는 것이죠.

함수를 하나의 값처럼 다룰 수 있기 때문에 **객체지향 패러다임에서 클래스를 재사용하는 것처럼 함수를 재사용할 수 있게됩니다.**

# 익명 클래스

자바에서는 **일급 객체와 유사한 동작을 하기 위해**, 단 하나의 메서드만을 가진 인터페이스, 혹은 클래스를 익명 클래스의 형태로 구현해 사용해 왔습니다.

```java
// 익명 클래스 생성과 동시에 주입
new Thread(new Runnable() {
   @Override
   public void run() { 
      System.out.println("Hello World!"); 
   }
}).start();
```

하지만 익명 클래스로 구현하기엔 코드의 길이가 너무 길어 부적합하고, **가독성을 떨어트린다는 단점**이 있습니다.

# 람다(Lambda Expression)

람다란 함수(메서드)를 간단한 ‘식(expression)’으로 표현하는 방법입니다.  **함수를 보다 단순하게 표현하는 방법**이라고 생각하시면 됩니다,

람다 함수는 이름을 가질 필요가 없기 때문에 익명 함수로서 활용 할 수 있습니다.

```java
// 기존의 방식
반환티입 메소드명 (매개변수, ...) {
	실행문
}

public String hello() {
    return "Hello World!";
}

// 람다 방식
(매개변수, ... ) -> { 실행문 ... }

() -> "Hello World!";
```

람다식을 통해 코드의 길이가 줄어들고 가독성이 좋아졌지만, 람다식을 인수로 주거나 인자로 받을 수 없기에 일급 객체로 활용하기에는 좀 버거워 보입니다.

# 함수형 인터페이스

**단 하나의 추상 메서드를 가지는 인터페이스**입니다. 내부에 선언된 함수를 1급 객체처럼 다룰 수 있게 해주며, **@Functionallnterface 어노테이션을 통해 명시적으로 선언**할 수 있습니다.

함수형 인터페이스는 내부의 추상 메서드를 구현하는 구현체를 익명 클래스 혹은 **람다식으로 구현해 사용할 수 있습니다.**

```java
// 단 하나의 추상 메서드만을 가지는 함수형 인터페이스
interface MyFunction2 {
    int max(int a, int b);
}

// @FunctionalInterface 어노테이션을 통해 명시적으로 선언한 함수형 인터페이스
@FunctionalInterface
interface MyFunction2 {
    int max(int a, int b);
}
```

> @FunctionalInterface 어노테이션으로 선언된 함수형 인터페이스에 두 개 이상의 메서드를 선언하면 오류를 발생시킵니다.
>

**중요한 것은 람다식으로 구현해서 사용할 수 있다는 부분**입니다.

```java
// 람다식을 변수에 저장
Runnable run = () -> System.out.println("Hello World!");

new Thread(run).start();
```

# 추가로 공부하면 좋을 키워드

- 명령형 프로그래밍 vs 선언형 프로그래밍
- 다양한 람다 표현식
- 람다식을 활용한 병렬 프로그래밍
- 자바에서 지원하는 java.util.function 인터페이스들

# 참고

[https://warpgate3.tistory.com/entry/자바코드로-보는-함수형-프로그래밍-Functional-Programming-in-Java](https://warpgate3.tistory.com/entry/%EC%9E%90%EB%B0%94%EC%BD%94%EB%93%9C%EB%A1%9C-%EB%B3%B4%EB%8A%94-%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-Functional-Programming-in-Java)

[https://tecoble.techcourse.co.kr/post/2021-09-30-java8-functional-programming/](https://tecoble.techcourse.co.kr/post/2021-09-30-java8-functional-programming/)

[https://engineering.linecorp.com/ko/blog/functional-programing-language-and-line-game-cloud/](https://engineering.linecorp.com/ko/blog/functional-programing-language-and-line-game-cloud/)
